# 컴퓨터 프로그램의 본질

<p align="center">
<b>[매운맛 C언어 입문]</b> <br />
시작 ⇒ <b>1. 컴퓨터 프로그램의 본질</b> ⇒ <a href="2. 표준 입출력.md">2. 표준 입출력</a>
</p>

## 환영합니다!
이 문서를 보셨다는 것은 아마 C에 대해 _아주 모르지만_, 한번 제대로 배워보고자 오신 분이라고 생각됩니다. 저는 애초에 이 문서를 작성할 때 C는 커녕 컴퓨터 프로그래밍에 대한 개념조차 잡히지 않은 분들을 타겟으로 하고자 하였습니다. 따라서 앞으로의 과정은 굉장히 고난이 뒤따를 것이며, 중도 포기하고 다른 (쉽다고 생각되는) 언어들 - 파이썬이나 자바스크립트 등 - 로 방향을 되돌리고 싶은 생각이 굉장히 많이 들 수도 있습니다. 하지만 저는 그러한 생각에 대해 _절대_ 비난하지 않습니다. 모든 공부는 순서가 있기 마련이고, 쉬운 것부터 차근차근 나아가는 것은 공부에 있어서 정공법이나 다름없기 때문입니다.

하지만, 저는 이 생각을 조금 비틀어보고자 합니다. 분명 오개념 습득의 위험성이 높아지지만, 제대로 학습이 될 수만 있다면 효과가 엄청나다고 생각되기에 매운맛 C 시리즈를 시작하였습니다. 그러므로 이 시리즈를 읽고자 하시는 분들은 다음을 유의해주시기 바랍니다.

 * 앞으로 나오는 기능들의 임의적 해석 금지 - 글자 그대로 받아들이라는 의미입니다.
 * 현재 개념을 완벽하게 습득하기 전까지 다음 개념을 찾아보지 말 것
 
이러한 사항들을 잘 따라 주신다면, 아마 이 시리즈를 완독할 시점에는 학부 2~3학년 수준의 기초적인 자료구조, 컴퓨터 구조 및 운영체제론에 대한 지식을 어느정도 습득하실 수 있을것이라고 생각됩니다.

1단원은 컴퓨터 프로그램이란 무엇인지, C언어란 무엇이고 이것이 컴퓨터 내에서 어떻게 처리되어 실행 가능한 프로그램으로 만들어지고 실행되는지에 대해 다룹니다. 처음부터 자칫 지루할지도 모르겠지만 매운 맛은 자비가 없다는 사실을 알아야 합니다.

참고로, 컴퓨터의 역사니 뭐니 하는 자잘한 부분들은 최대한 쳐내버렸습니다. 제가 그런걸 싫어하기도 하고, 무엇보다도 재미가 없습니다. 우리는 프로그래밍 도구로서의 C언어를 공부하러 왔지 역사를 공부하러 온 것이 아니니까요. 역사에 관한 내용이 궁금하다면 구글에 검색하면 잔뜩 나올겁니다.

## 프로그래밍을 한다는 것
프로그래밍을 한다는 것은 참 많은 단어와 문구로 정의할 수 있지만, 저는 프로그래밍을 `어떠한 계산을 컴퓨터에게 부담시키기 위하여(실행하기 위하여) 명령어를 나열한 문서(프로그램)를 작성하는 것`이라고 정의합니다. 컴퓨터는 계산을 위하여 만들어진 장치이고, 인간이 처리하기 어렵거나 불가능한 계산들을 처리하는데 있어 최적이기 때문입니다.

### 기계어와 어셈블리어, 그리고 C언어
컴퓨터는 반도체가 모여 만들어진 전기로 동작하는 기계입니다. 회로판을 타고 돌아다니는 전자의 움직임에 따라 그 동작이 결정되고, 컴퓨터 각 부분의 상태는 0과 1로 정의됩니다. 0과 1로 표현되는 상태 하나를 bit라고 하며, 이들 bit가 모여 정보를 나타냅니다.

컴퓨터가 연산을 처리하여 결과를 내놓기 위해서는, 다시 말해 출력을 내놓기 위해서는 그에 알맞는 입력이 필요합니다. 지금 윈도우 계산기(calc.exe)를 켜고 3 + 5, 4 + 5 등을 입력한 뒤 엔터를 치면 8, 9 와 같은 결과가 나올 것입니다. 하지만 이것은 인간의 편의를 위해 컴퓨터의 실제 동작을 추상화 한 것에 불과합니다. 컴퓨터는 인간이 사용하는 연산자를 이해할 수 없기 때문입니다.

위에서 말했듯 컴퓨터의 모든 상태는 bit의 집합으로 정의됩니다. 당연히 어떤 연산을 실행하라는 명령 조차도 0과 1로 표현됩니다. 이것을 우리는 기계어라고 표현하며 컴퓨터가 실제로 읽고 이해할 수 있는 형태입니다.

위에서 말한 4 + 5의 경우를 우리가 흔히 사용하는 x86-64 컴퓨터의 기계어로 표현하면 다음과 같습니다. 

```
00110001 11000000
10111000 00000100 00000000 00000000 00000000
10000011 11000000 00000101
```
 * calc.exe에서 4 + 5를 할 때 실제 일어나는 연산은 이것보다 훨씬 많습니다. 여기서는 4 + 5 라는 계산 그 자체만을 보여줍니다.

확실히 한눈에 알아보기 어렵습니다. 그래서 어셈블리어라고 하는, 기계어와 1대 1로 대응되는 어셈블리어가 등장합니다. 다음 어셈블리어는 저 기계어를 어셈블리어로 표현한 것입니다.

```asm
    xor eax, eax     ; eax를 0으로 만든다
    mov eax, 4       ; eax에 4를 대입
    add eax, 5       ; eax에 5를 더한다
```

일단 명령어를 알아보기가 쉬워진데다 각 코드가 어떤 역할을 하는지에 대한 메모 같은 것들을 추가할 수 있게 됐습니다. 하지만 이래도 근본적인 문제는 해결되지 않습니다. 어셈블리는 어디까지나 기계어를 읽기 쉽게 만든 것이고, 기계어는 또 CPU의 기종마다 다르기 때문에 x86-64가 아닌 ARM이나 MIPS 등을 사용하게 되면 그 기계에 맞는 명령어들을 익힐 필요가 있습니다. 다시 말해 작성한 소스코드를 재활용하기가 어려워집니다.

이런 상황 속에서 여러 언어들이 등장하고 사라져 가는 가운데, 1972년 데니스 리치가 C언어를 만들어 내놓습니다. UNIX 운영체제를 만들기 위해 나온 언어인 C언어는 하드웨어와 밀접하게 동작하면서도 읽고 쓰기 간편한 점, 그리고 기종을 따르지 않는 다는 점에서 큰 인기를 얻어 지금까지도 여러 분야에서 광범위하게 사용되고 있습니다. 위에 나온 예시를 C언어로 표현하면 다음과 같이 표현할 수 있습니다.

```c
int sum = 5 + 4;
```

확실히 프로그램을 인간의 언어에 가깝게 표현할 수 있어 프로그램을 직관적으로 작성하고 분석할 수 있게 되었습니다. 이렇듯 인간이 이해하기 좋은 표현을 사용하는 언어를 **고급언어**, 기계어나 어셈블리와 같이 기계가 이해하기 좋은 표현을 사용하는 언어를 **저급언어**라고 부릅니다. 

## 소스코드부터 실행파일까지
C언어를 비롯한 고급언어는 분명 알아보기 쉽지만 컴퓨터가 이해하고 실행 가능한 형태와는 다소 거리가 멉니다. C언어로 작성 된 코드를 소스코드(혹은 원시코드) 라고 부르는데 이것은 단지 텍스트파일일 뿐입니다. 다시 말해, 메모장 켜서 아무말이나 써놓은 것과 다르지 않다는 말입니다.

그러므로 소스코드를 기계어로 바꿔주기 위한 프로그램이 필요한데 이것을 컴파일러라고 부릅니다. C언어는 처음 나온 이래로 50년 가까이 사용되어오면서 다양한 컴파일러들이 개발되어 사용되었습니다. 현재는 자유 소프트웨어 재단이 개발하고 관리하는 gcc, 애플의 후원을 받는 clang, 그리고 마이크로소프트에서 제작한 MSVC 가 주로 사용되고 있습니다.

### 소스코드를 작성하기 위한 도구
소스코드는 단지 텍스트 파일일 뿐입니다. 따라서 메모장이나 워드패드 등 txt파일을 작성할 수 있는 아무 프로그램으로나 작성이 가능합니다. 하지만 컴파일러가 읽어야 하는 프로그램의 설계도이기도 하기 때문에 효율적이고 정확한 소스코드 작성을 위한 도구가 끊임없이 출시되고 있습니다. 이러한 도구들은 단순히 소스코드를 읽기 좋게 만들어줄 뿐만이 아니라, 컴파일러와 연동되어 코드의 오류나 잠재적인 위험성을 검사해주기도 합니다. 각각의 도구는 지원하는 기능이 조금씩 다르지만, 현대의 개발 도구들은 대개 다음 기능들을 제공합니다.

 * **소스 하이라이팅** : 소스코드의 각 부분별로 글자에 색깔을 입히거나 볼드체, 밑줄 등을 그어줍니다.
 * **자동완성** : 현재 입력중인 단어를 기반으로 자동으로 입력 가능한 변수, 상수, 키워드, 함수 등의 목록을 밑에 띄워주고, 선택된 단어를 자동으로 입력해줍니다.
 * **문법 검사** : 전체 소스코드를 실시간으로 검사하여 C언어의 문법에 맞게 프로그램이 작성되었는지 검사합니다. 올바르지 않은 코드가 발견될 경우 빨간 밑줄이나 오류 목록을 통해 오류가 있음을 알려줍니다.
 * **디버거** : 실행중인 프로그램에 붙어 여러가지 상태를 진단하도록 도와주는 프로그램입니다. 프로그램에 발생하는 오류(버그)를 잡는데 사용된다 하여 디버거라고 부릅니다. 

단순한 소스코드 에디터의 경우 자동완성까지 지원하는 경우가 많으며, 나머지 4가지 기능을 지원하는 경우 통합 개발 환경(IDE) 이라고 하여 프로그램 개발 전반에 필요한 기능들을 제공하는 소프트웨어 집합체입니다.

C언어는 그 오랜 역사동안 수 많은 개발 보조 도구가 등장하고 사라졌습니다. 지금도 C언어를 개발하기 위한 도구가 많이 나와 있으며 어떤 도구를 선택하는것이 최선인것인가에 대해 여러모로 갑론을박이 벌어지고 있습니다.

### 컴파일, 링킹, 그리고 빌드
컴파일은 단어 뜻 그대로 소스코드를 기계어로 번역함을 의미합니다. 이때 생성되는 파일은 어셈블리어 코드로, 곧 어셈블러에 의해 목적 코드파일(기계어)로 변환됩니다.

목적 코드는 기계어로 이루어져 있으나 그 자체로서 실행 가능한 파일이 아니며, 외부 라이브러리 함수나 다른 소스코드의 함수 등을 사용했을 수도 있고 또한 프로그램 파일의 알맞은 위치에 코드가 위치될 수 있도록 해주어야 합니다. 이 과정을 링킹이라고 하며 링커에 의해 수행됩니다.

링크 작업이 완료되면 비로소 실행 가능한 실행 파일이 생성됩니다. 빌드는 실행 파일을 생성하는 일련의 과정을 의미하며, 지금 설명한 내용 가운데에는 전처리과정 등이 생략되어 있습니다. 자세한 내용은 **12. 전처리기** 및 **13. 라이브러리**에서 다룹니다.

## C 프로그램의 기본 구조
본격적으로 시작하기에 앞서, C 프로그램 소스코드의 기본 구조에 대해 알아보겠습니다. 데니스 리치가 쓴 C언어 학습서인 **The C Programming Language**에서 다룬 이래로, 수 많은 프로그램 언어 입문서에서 등장한 예제인 `Hello, World!`를 예시로 들어보겠습니다.

```c
#include <stdio.h>

int main()
{
    printf("Hello, World!"); // Hello, World! 를 출력
    return 0;
}
```

 * `#include` 는 전처리기라고 불리는 기능중 하나로, 다음에 나오는 파일명을 가진 파일을 소스코드에 포함시키라는 의미입니다. 전처리기에 대한 자세한 내용은 **12. 전처리기**에서 알아봅니다.
 * `int main()`은 C언어 프로그램에서 필수적으로 작성해야 하는 부분으로, 프로그램이 시작되는 지점을 정의합니다. 이것을 진입점(Entry Point)라고 부릅니다.
 * C에서 중괄호를 포함한 모든 열린 괄호는 반드시 닫혀야 합니다. 특히 중괄호가 중요한데, 프로그램 코드를 작성할 때 주로 중괄호 안에 작성하며, 이들 중괄호 쌍 내부를 블록이라고 표현합니다. 블록은 스코프를 형성하며, 스코프에 대해서는 **6. 서브루틴과 함수** 에서 자세히 다룹니다.
 * C에서 개별 명령은 Statement라고 불립니다. Statement에는 변수 할당, 함수 호출 등이 포함되며 이들 Statement는 ;(세미콜론)으로 마무리되어야 합니다. C 컴파일러는 줄바꿈을 Statement의 끝이라고 인식하지 못하기 때문에, 한 Statement가 끝났음을 세미콜론을 통해 인식합니다.
 * `//`은 주석(Comment) 입니다. 주석의 시작지점 부터 현재 줄 전체를 주석처리합니다. 여러 줄을 주석처리할 때는 `/*` 로 시작하여 `*/`로 끝내면 됩니다. 컴파일러는 주석을 코드라고 인식하지 않으며, 따라서 소스코드의 이해를 돕기 위한 메모 등을 추가할 수 있습니다.

## 챕터 정리하기
 1. C언어는 컴퓨터 프로그램을 작성하기 위한 프로그래밍 언어로, 인간의 입장에서 해석이 용이한 **고급언어**이며 기계가 해석할 수 있는 기계어 등의 **저급언어**와 대비된다.
 2. C언어 소스코드는 단순한 텍스트 파일로, 컴파일러를 통해 기계어로 번역되어야 한다. 
 3. 기계어로 번역된 코드는 링커, 어셈블러를 통해 실행 가능한 실행파일이 된다.

<p align="center">
<b>[매운맛 C언어 입문]</b> <br />
시작 ⇒ <b>1. 컴퓨터 프로그램의 본질</b> ⇒ <a href="2. 표준 입출력.md">2. 표준 입출력</a>
</p>
